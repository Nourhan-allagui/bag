<div class="home-container">

  <div id="carouselExampleDark" class="carousel carousel-dark slide card-size" data-bs-ride="carousel">
    <div class="carousel-indicators">
      <button *ngFor="let img of pubImgBags; let i = index"
              type="button"
              data-bs-target="#carouselExampleDark"
              [attr.data-bs-slide-to]="i"
              [class.active]="i === 0"
              [attr.aria-current]="i === 0 ? 'true' : null"
              [attr.aria-label]="'Slide ' + (i + 1)">
      </button>
    </div>
    <div class="carousel-inner">
      <div *ngFor="let img of pubImgBags; let i = index"
           class="carousel-item"
           [class.active]="i === 0"
           [attr.data-bs-interval]="10000">
        <img [src]="img" class="d-block w-100" alt="Bags image">
        <div class="carousel-caption d-none d-md-block">
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div class="card-group cards-size">
    <div class="card" *ngFor="let detail of genderType" (click)="goToShop()">
      <img [src]="detail.images" class="card-img-top" alt="...">
      <div class="card-body">
        <h1 class="card-title">{{detail.name}}</h1>
        <p class="card-text">{{detail.description}}</p>
        <a href="#" class="btn btns">{{detail.buttons}}</a>
      </div>
    </div>
  </div>
  <div class="smallnav">
    <h1 class="shopTitle">Product Overview</h1>
  </div>
  <div class="carts-thirds">
    <ul class="nav">
      <li class="nav-item">
        <a class="nav-link" [class.active]="activeGender === 'All'" aria-current="page" (click)="resetFilter()">All Products</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" [class.active]="activeGender === 'Women'" (click)="filterByGender('Women')">Women</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" [class.active]="activeGender === 'Men'" (click)="filterByGender('Men')">Men</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" [class.active]="activeGender === 'Children'" (click)="filterByGender('Children')">Children</a>
      </li>
    </ul>
    <div class="cards-fourth">
    <p>
      <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapseExample1" role="button" aria-expanded="false" aria-controls="collapseExample1" data-bs-target="#collapseExample2">
        <i class="fa-solid fa-magnifying-glass"></i> Search
      </a>
    </p>
    </div>
  </div>
  <div class="collapse" id="collapseExample2">
    <div class="card card-body">
      <div class="input-group">
        <input type="text"
               class="form-control searchInput"
               placeholder="Search Bags..."
               [(ngModel)]="searchTerm"
               (input)="applyFilters()">
        <button class="btn btn-cards" type="button" (click)="clearSearch()">
          CLEAN
        </button>
        <button class="btn btn-cards" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample2">
          OK
        </button>
      </div>
    </div>
  </div>

  <div class="cards-fifith">
      <div class="row">
        <div *ngFor="let bag of filteredBags" class="col-lg-3 col-md-4 mb-3">
          <div class="card" (click)="openModal(bag)" style="cursor: pointer; height: 100%;">
            <img [src]="bag.images[0]" class="card-img-top" alt="{{ bag.name }}">
            <div class="card-body articleDetails">
              <div class="detailsSide">
              <h5 class="card-title">{{ bag.name }}</h5>
              <p class="card-text">{{ bag.description }}</p>
              </div>
              <p class="card-text">{{ bag.price }} TND</p>
            </div>
          </div>
        </div>
    </div>
    <div class="modal fade" id="bagModal" tabindex="-1">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="modal-header">
            <h5 class="modal-title">{{ selectedBag?.name }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="images-display">
              <img [src]="currentImage" class="img-fluid mb-3 big-image" alt="Main image">
              <div class="d-flex gap-2 small-photo">
                <img *ngFor="let thumb of selectedBag?.photos"
                     [src]="thumb"
                     class="img-thumbnail"
                     style="cursor: pointer;"
                     (click)="changeImage(thumb)"
                     alt="bags image">
              </div>
            </div>
            <div class="bags-details">
              <h1 class="mt-3">{{ selectedBag?.name }}</h1>
              <h3><strong>{{ selectedBag?.price}} TND</strong></h3>
              <p>{{selectedBag?.description}}</p>
              <div *ngIf="selectedBag" class="dropdown" style="margin-bottom: 1rem;">
                <label>Size:
                  <button
                    class="btn btn-light btn-lg dropdown-toggle"
                    type="button"
                    id="dropdownSize"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    [disabled]="availableSizes.length <= 1"
                  >
                    {{ selectedSize || 'Choose a size' }}
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownSize">
                    <ng-container *ngIf="availableSizes.length > 1; else noSizes">
                      <li *ngFor="let size of availableSizes">
                        <button
                          *ngIf="size !== selectedSize"
                          class="dropdown-item"
                          type="button"
                          (click)="sizeSelect(size)"
                        >
                          {{ size }}
                        </button>
                      </li>
                    </ng-container>
                    <ng-template #noSizes>
                      <li class="dropdown-item disabled">No sizes available</li>
                    </ng-template>
                  </ul>
                </label>
              </div>
              <div *ngIf="selectedBag" class="dropdown" style="margin-bottom: 1rem;">
                <label>Color:
                  <button
                    class="btn btn-light btn-lg dropdown-toggle"
                    type="button"
                    id="dropdownColor"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    [disabled]="availableColorsForBag.length <= 1"
                  >
                    {{ selectedColor || 'Choose a color' }}
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownColor">
                    <ng-container *ngIf="availableColorsForBag.length > 1; else noColors">
                      <li *ngFor="let color of availableColorsForBag">
                        <button
                          *ngIf="color !== selectedColor"
                          class="dropdown-item"
                          type="button"
                          (click)="colorSelect(color)"
                        >
                          {{ color }}
                        </button>
                      </li>
                    </ng-container>
                    <ng-template #noColors>
                      <li class="dropdown-item disabled">No colors available</li>
                    </ng-template>
                  </ul>
                </label>
              </div>

              <div class="quantiyBags">
                <label>Quantity:
                  <button class="btn" (click)="decrementNumber()">-</button>
                  <p>{{ selectedBag?.quantity }}</p>
                  <button class="btn" (click)="incrementNumber()">+</button>
                </label>
              </div>
              <div class="addButton">
                <button
                  class="btn btn-success"
                  (click)="addToCart()"
                  title="Total price : {{selectedBag?.quantity * selectedBag?.price}}">
                  ADD TO CART
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  <button type="button" class="btn more-button btn-outline-secondary" (click)="goToShop()">LOAD MORE</button>
</div>
</div>
