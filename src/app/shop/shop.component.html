<div class="shop-container">
  <div class="shop-content">
    <div class="vitrine"></div>
    <div class="small-nav">
      <div class="carts-thirds">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeGender === 'All'" (click)="resetFilter()">All Products</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeGender === 'Women'" (click)="filterByGender('Women')">Women</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeGender === 'Men'" (click)="filterByGender('Men')">Men</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeGender === 'Children'" (click)="filterByGender('Children')">Children</a>
          </li>
        </ul>
        <div class="cards-fourth">
          <p>
            <a class="btn btn-primary" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="collapseExample2" data-bs-target="#collapseExample2">
              <i class="fa-solid fa-magnifying-glass"></i> Search
            </a>
            <a
              class="btn btn-primary"
              data-bs-toggle="collapse"
              role="button"
              aria-expanded="false"
              aria-controls="collapseExample1"
              data-bs-target="#collapseExample1"
            >
              <i class="fa-solid fa-filter"></i> Filter
            </a>
          </p>
        </div>
      </div>
      <div class="collapse my-collapse" id="collapseExample2">
        <div class="card card-body">
          <div class="input-group">
            <input
              type="text"
              class="form-control searchInput"
              placeholder="Search Bags..."
              [(ngModel)]="searchTerm"
              (input)="applyFilters()"
            />
            <button
              class="btn btn-cards"
              type="button"
              (click)="clearSearch()"
            >
              CLEAN
            </button>
            <button
              class="btn btn-cards"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapseExample2"
              aria-expanded="true"
              aria-controls="collapseExample2"
            >
              OK
            </button>
          </div>
        </div>
      </div>

    </div>
    <div class="shop-catalogue">
      <div class="collapse" id="collapseExample1">
        <div class="shop-filter">
          <div class="accordion" id="accordionExample">
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  Sort By
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <ul>
                    <li><a (click)="sortBags('default')">Default</a></li>
                    <li><a (click)="sortBags('bestSelling')">Best selling</a></li>
                    <li><a (click)="sortBags('az')">Alphabetically, A-Z</a></li>
                    <li><a (click)="sortBags('za')">Alphabetically, Z-A</a></li>
                    <li><a (click)="sortBags('priceLowHigh')">Price, low to high</a></li>
                    <li><a (click)="sortBags('priceHighLow')">Price, high to low</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingTwo">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Availability
                </button>
              </h2>
              <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault"
                           [(ngModel)]="inStockOnly" (change)="applyFilters()">
                    <label class="form-check-label" for="switchCheckDefault">In stock only</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingThree">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  Color
                </button>
              </h2>
              <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <ul>
                    <li *ngFor="let color of ['Beige', 'Black', 'Blue', 'Brown', 'Gold', 'Green', 'Grey', 'Red']">
                      <input
                        class="form-check-input"
                        type="checkbox"
                        [id]="color.toLowerCase()"
                        [value]="color"
                        (change)="onColorChange($event)"
                        [checked]="selectedColors.includes(color)" />
                      <label [for]="color.toLowerCase()">
                        <span class="coleur"></span> {{ color }}
                      </label>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingFour">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                  Category
                </button>
              </h2>
              <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <ul>
                    <li *ngFor="let category of categoryOptions; let i = index">
                      <input
                        class="form-check-input"
                        type="checkbox"
                        [id]="'bags' + (i + 1)"
                        [value]="category"
                        (change)="onCategoryChange($event)"
                        name="interest"
                      />
                      <label [for]="'bags' + (i + 1)">{{ category }}</label>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingFive">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                  Price
                </button>
              </h2>
              <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                  <div class="range-wrap" style="text-align: center">
                    <div class="range-value" [ngStyle]="{ left: rangePosition }">
                      <span>{{ rangeValue }}</span>
                    </div>
                    <input
                      type="range"
                      min="0"
                      max="300"
                      step="1"
                      [value]="rangeValue"
                      (input)="onRangeChange($event)"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="cards-fifith">
        <div class="row">
          <div *ngFor="let bag of filteredBags | slice:0:displayLimit" class="col-md-4 col-lg-3 mb-3">
            <div class="card" (click)="openModal(bag)" style="cursor: pointer; height: 100%">
              <img [src]="bag.images[0]" class="card-img-top" alt="{{ bag.name }}">
              <div class="card-body articleDetails">
                <div class="detailsSide">
                  <h5 class="card-title">{{ bag.name }}</h5>
                  <p class="card-text">{{ bag.description }}</p>
                </div>
                <p class="card-text">${{ bag.price }}</p>
              </div>
            </div>
          </div>
        </div>
        <div class="modal fade" id="bagModal" tabindex="-1">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content p-3">
              <div class="modal-header">
                <h5 class="modal-title">{{ selectedBag?.name }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="images-display">
                  <img [src]="currentImage" class="img-fluid mb-3 big-image" alt="Main image">
                  <div class="d-flex gap-2 small-photo">
                    <img *ngFor="let thumb of selectedBag?.photos"
                         [src]="thumb"
                         class="img-thumbnail"
                         style="cursor: pointer;"
                         (click)="changeImage(thumb)"
                         alt="bags image">
                  </div>
                </div>
                <div class="bags-details">
                  <h1 class="mt-3">{{ selectedBag?.name }}</h1>
                  <h3><strong>{{ selectedBag?.price}} TND</strong></h3>
                  <p>{{selectedBag?.description}}</p>
                  <div class="dropdown">
                    <label>Size:
                      <button class="btn btn-light btn-lg dropdown-toggle" type="button" id="dropdownSize"
                              data-bs-toggle="dropdown" aria-expanded="false">
                        {{ selectedSize }}
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownSize">
                        <li><button class="dropdown-item" type="button" (click)="sizeSelect('Small')">Small</button></li>
                        <li><button class="dropdown-item" type="button" (click)="sizeSelect('Medium')">Medium</button></li>
                        <li><button class="dropdown-item" type="button" (click)="sizeSelect('Big')">Big</button></li>
                      </ul>
                    </label>
                  </div>
                  <div class="dropdown">
                    <label>Color :
                      <button class="btn btn-light btn-lg dropdown-toggle" type="button" id="dropdownColor" data-bs-toggle="dropdown" aria-expanded="false">
                        {{selectedColor}}
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownColor">
                        <li><button class="dropdown-item" type="button" (click)="colorSelect('Red')">Red</button></li>
                        <li><button class="dropdown-item" type="button" (click)="colorSelect('Blue')">Blue</button></li>
                        <li><button class="dropdown-item" type="button" (click)="colorSelect('Green')">Green</button></li>
                      </ul>
                    </label>
                  </div>
                  <div class="quantiyBags">
                    <label>Quantity:
                      <button class="btn" (click)="decrementNumber()">-</button>
                      <p>{{ selectedBag?.quantity }}</p>
                      <button class="btn" (click)="incrementNumber()">+</button>
                    </label>
                  </div>
                  <div class="addButton">
                    <button
                      class="btn btn-success"
                      (click)="addToCart()"
                      title="Total price : {{selectedBag?.quantity * selectedBag?.price}}">
                      ADD TO CART
                    </button>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button
          *ngIf="filteredBags.length > displayLimit"
          type="button"
          class="btn more-button btn-outline-secondary"
          (click)="loadMore()">
          LOAD MORE
        </button>
      </div>
    </div>
  </div>
</div>

<div
  id="toastAddCart"
  class="toast align-items-center text-white bg-success border-0 position-fixed bottom-0 end-0 m-3"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
>
  <div class="d-flex">
    <div class="toast-body">
      Item added to cart successfully!
    </div>
    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
  </div>
</div>
